{
  "path": "../../src/builder/vite/vite.config.spa.js",
  "relativePath": "builder/vite/vite.config.spa.js",
  "type": "source",
  "name": "vite.config.spa.js",
  "extension": ".js",
  "analysis": {
    "Summary": "This file exports a function that generates a Vite configuration object tailored for building a single-page application (SPA). It merges a base Vite config with SPA-specific settings such as entry point, output directory, HTML templating, custom build plugins, and development server options.",
    "Purpose": "Provide the project’s SPA build configuration for Vite by composing common/base settings with SPA-specific overrides and plugins.",
    "Components": [
      {
        "name": "spaConfig",
        "type": "Object",
        "description": "Defines Vite mode, build options (entry, output directory, cleaning), plugins (HTML generation, stats writer, chunk limiter), and dev server settings."
      },
      {
        "name": "HTML Plugin",
        "type": "Plugin",
        "description": "createHtmlPlugin instance that injects environment data into an HTML template and performs minification in production."
      },
      {
        "name": "stats-writer",
        "type": "Plugin",
        "description": "Custom Vite plugin that runs on build and writes a stats.json file with sizes of each bundle asset."
      },
      {
        "name": "limit-chunks",
        "type": "Plugin",
        "description": "Custom Vite plugin that forces all code into a single chunk by overriding rollup manualChunks."
      }
    ],
    "Functions": [
      {
        "name": "default export (buildSpaConfig)",
        "params": [
          "projectRoot"
        ],
        "description": "Main function. Determines production flag, defines spaConfig, merges it with the base config from vite.config.base.js, and returns the combined Vite config."
      },
      {
        "name": "stats-writer.writeBundle",
        "params": [
          "options",
          "bundle"
        ],
        "description": "Plugin hook that serializes the bundle’s asset sizes into stats.json in the build output directory."
      },
      {
        "name": "limit-chunks.config",
        "params": [
          "config"
        ],
        "description": "Plugin hook that ensures rollupOptions.output.manualChunks is set so that all modules are bundled into a single chunk."
      }
    ],
    "Dependencies": [
      "fs",
      "lodash",
      "path",
      "vite-plugin-html (createHtmlPlugin)",
      "../templates/page.js",
      "./vite.config.base.js"
    ],
    "Usage": "Imported by the project’s build scripts or Vite CLI. Called with the absolute path to the project root to produce a complete Vite config object for SPA builds.",
    "Importance": 4,
    "Notes": [
      "Environment variables NODE_ENV, GOOGLE_TAG_ID, and GOOGLE_MAPS_API_KEY are injected into the HTML template.",
      "Replicates some Webpack plugin behaviors (StatsWriterPlugin, LimitChunkCountPlugin) as Vite plugins.",
      "Includes commented-out static copy plugin snippet for future use.",
      "Empty output directory before each build and supports hot reloading in development."
    ]
  }
}