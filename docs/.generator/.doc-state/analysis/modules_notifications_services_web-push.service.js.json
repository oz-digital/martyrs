{
  "path": "../../src/modules/notifications/services/web-push.service.js",
  "relativePath": "modules/notifications/services/web-push.service.js",
  "type": "source",
  "name": "web-push.service.js",
  "extension": ".js",
  "analysis": {
    "Summary": "This file configures VAPID keys for Web Push notifications using the 'web-push' library and exports a service object that can send push notifications to subscribers.",
    "Purpose": "Provide a reusable service for sending web push notifications throughout the application, handling payload construction, VAPID setup, and error management.",
    "Components": [
      {
        "name": "WebPushService",
        "type": "service object",
        "responsibilities": [
          "Parse subscription tokens",
          "Build notification payloads (title, body, icon, badge, data)",
          "Send notifications via the web-push library",
          "Log operation details and errors"
        ]
      }
    ],
    "Functions": [
      {
        "name": "send",
        "description": "Asynchronously sends a web push notification to a subscriber using a parsed subscription token and the provided notification content.",
        "parameters": [
          {
            "name": "token",
            "type": "string",
            "description": "A JSON-stringified subscription object returned by the browser's Push API."
          },
          {
            "name": "title",
            "type": "string",
            "description": "The notification title."
          },
          {
            "name": "body",
            "type": "string",
            "description": "The notification body text."
          },
          {
            "name": "data",
            "type": "object",
            "description": "Optional payload data to attach to the notification.",
            "default": {}
          }
        ],
        "returns": {
          "type": "Promise<object>",
          "description": "Resolves with an object containing success status and HTTP status code of the push request."
        }
      }
    ],
    "Dependencies": [
      {
        "module": "web-push",
        "purpose": "Library to send Web Push notifications and manage VAPID configuration."
      },
      {
        "module": "process.env",
        "variables": [
          "VAPID_EMAIL",
          "VAPID_PUBLIC_KEY",
          "VAPID_PRIVATE_KEY",
          "NOTIFICATION_ICON_URL",
          "NOTIFICATION_BADGE_URL"
        ],
        "purpose": "Environment variables for VAPID credentials and default notification assets."
      }
    ],
    "Usage": "Import the default export and call WebPushService.send({ token, title, body, data }) wherever push notifications need to be triggered (e.g., in controllers, event handlers, or cron jobs).",
    "Importance": 3,
    "Notes": [
      "VAPID keys are set at import time; ensure environment variables are loaded before requiring this module.",
      "The token must be a valid JSON string of a PushSubscription object or JSON.parse will throw.",
      "Console logging is used for debugging; consider replacing with a structured logger in production.",
      "Errors during sendNotification are caught, logged, and rethrown to allow upstream handling."
    ]
  }
}