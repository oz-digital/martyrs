{
  "path": "../../src/builder/vite/vite.config.server.js",
  "relativePath": "builder/vite/vite.config.server.js",
  "type": "source",
  "name": "vite.config.server.js",
  "extension": ".js",
  "analysis": {
    "Summary": "Этот файл экспортирует функцию, которая генерирует Vite конфигурацию для серверного рендеринга (SSR) в режиме разработки, учитывая встроенные модули Node.js, исключая их из бандла и настраивая плагины для полифиллов и HMR.",
    "Purpose": "Обеспечить готовую конфигурацию Vite для сборки и запуска серверного кода (SSR) проекта на Node.js с поддержкой HMR и управлением внешними зависимостями.",
    "Components": [
      {
        "name": "default export",
        "type": "Function",
        "responsibility": "Принимает путь к корню проекта и возвращает объект конфигурации Vite для SSR."
      },
      {
        "name": "vite-plugin-node-polyfills",
        "type": "Plugin object",
        "responsibility": "Добавляет псевдо-алиасы для Node.js модулей (path) чтобы Vite не пытался бандлить их."
      },
      {
        "name": "vite-plugin-ssr-hmr",
        "type": "Plugin object",
        "responsibility": "Настраивает поддержку HMR для серверного кода: следит за изменениями в файлах `src/**/*` и выводит в консоль сообщения при изменениях."
      }
    ],
    "Functions": [
      {
        "name": "defaultExport",
        "params": [
          "projectRoot"
        ],
        "returns": "Vite configuration object",
        "description": "Генерирует конфиг для серверной сборки: режим, внешние зависимости, пути, плагины и HMR."
      },
      {
        "name": "config (vite-plugin-node-polyfills)",
        "params": [
          "config"
        ],
        "returns": "void (мутирует переданный config)",
        "description": "Добавляет alias `path: false` для отключения встроенного path-модуля в сборке."
      },
      {
        "name": "configureServer (vite-plugin-ssr-hmr)",
        "params": [
          "server"
        ],
        "returns": "void",
        "description": "Добавляет файловый watcher на `src/**/*`, логирует изменения в файле `src/server` и полагается на встроенный механизм HMR Vite."
      },
      {
        "name": "watcher.on('change') callback",
        "params": [
          "file"
        ],
        "returns": "void",
        "description": "При изменении серверного файла выводит в консоль сообщение о перезагрузке."
      }
    ],
    "Dependencies": [
      {
        "module": "module",
        "importAs": "module$0",
        "usedFor": "builtinModules — список встроенных модулей Node.js"
      },
      {
        "module": "path",
        "importAs": "path",
        "usedFor": "формирование абсолютных путей к входному и выходному файлам"
      }
    ],
    "Usage": "Обычно файл подключается в процессе сборки — передаётся корень проекта в экспортируемую функцию, возвращаемая конфигурация передаётся Vite (`vite --config builder/vite/vite.config.server.js`) или используется внутри custom build-скрипта.",
    "Importance": 4,
    "Notes": [
      "Конфигурация жёстко зафиксирована на режим 'development'. Для production-сборок потребуется отдельный файл или доработка.",
      "В разделе ssr.noExternal указано `'**/node_modules/**'`, что заставляет Vite не включать ни один пакет из node_modules в бандл.",
      "Префикс `/^node:/` в external позволяет корректно обрабатывать новые импорты вида `node:fs` и т.п.",
      "Плагин `vite-plugin-node-polyfills` лишь создаёт алиасы, а не реальные полифиллы."
    ]
  }
}